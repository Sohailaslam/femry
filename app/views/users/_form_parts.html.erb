<div id='tasks'>
  <div class="row">
    <div class="col-md-10">
      <% day = key.present? ? display_date(key) : 'Today' %>
      <h3 class="mt-5"><%= key.present? ? display_date(key) : 'Today' %></h3>
    </div>
    <% if day == "Today" %>
      <div class="col-md-2">
        <div class="progress" data-percentage="<%= completed_percentage(f) %>">
          <span class="progress-left">
            <span class="progress-bar"></span>
          </span>
          <span class="progress-right">
            <span class="progress-bar"></span>
          </span>
          <div class="progress-value">
          </div>
        </div>
      </div>
    <% end %>    
  </div>  
  <div class="row">
    <div class="col-md-12">     
      <div class="add-task p-4">           
        <ul id="sortable<%= Date.today %>" class="sortable ui-sortable ">
          <%= f.fields_for :tasks, f.object.tasks.order("task_date DESC").order(:sort) do |task| %>
            <%= render 'task_fields', :f => task if key == task.object.task_date.to_date %>
          <% end %>       
        </ul>
      </div>
    </div>
  </div>
</div>
<div id='thoughts'>  
  <div class="row">
    <div class="col-md-12">
      <div class="add-task add-thought p-4">                
        <ul>
          <%= f.fields_for :thoughts, f.object.thoughts.order("thought_date DESC") do |thought| %>
            <%= render 'thought_fields', :f => thought  %>
          <% end %>     
        </ul>
      </div>
    </div>
  </div>
</div>    
<div class="row">
  <div class="col-md-12">
    <% @key = Date.today %>
    <%= link_to_add_association 'Add Task', f, :tasks, :partial => 'new_task_fields', class: 'btn btn-success mt-3' %>
    <%= link_to_add_association 'Add Thought', f, :thoughts, :partial => 'new_thought_fields', class: 'add-thoughts btn btn-outline-dark mt-3', id: 'add_thoughts' %>
  </div>
</div>
